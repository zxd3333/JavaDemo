
# 反射
Java反射机制指的是在Java程序运行状态中，对于任意一个类，都可以获取这个类的所有属性和方法  
对于给定的任意一个对象，都能够调用它的任意一个属性和方法  
这种动态获取类的内容以及动态调用对象的方法称为反射机制。

## 反射的具体实现
要想实现反射，必须拿到该类的字节码文件对象（.class），我们通过字节码文件对象就能获取类中的信息

## Java类的执行过程（了解）
当程序使用某个类时，如果该类还未被加载到内存中，系统会通过编译、加载、连接、初始化的步骤对类进行初始化  
如果不出意外，JVM将会连续完成这三个步骤

* 类的编译：.java文件编译后生成.class文件
* 类的加载：由类加载器根据类的全限定类名将.class文件读入内存，并为之创建一个Class类的对象。（任何类被使用时，系统都会为其建立一个Class类的对象）
* 类的连接：
    * 验证阶段：检验被加载的类是否有正确的内部结构，并和其他类协调一致
    * 准备阶段：给类的类变量分配内存，并设置默认初始化值
    * 解析阶段：将类的二进制数据中的符号引用替换为直接引用
* 类的初始化：主要就是对类变量进行初始化
    * 如果该类还未被加载和连接，则程序先加载并连接该类
    * 如果该类的父类还未初始化，则先初始化其父类
    * 如果类中有初始化语句，系统会依次执行这些初始化语句

### 类的初始化时机
* 创建类的实例，也就是new一个对象
* 调用类的方法
* 访问类或者接口的变量，或者为该变量赋值
* 使用反射方法强制创建某个类或者接口对应的java.lang.Class对象
* 初始化某个类的子类
* 直接使用java.exe命令来运行某个类

## 类加载器（了解）
* ClassLoader：负责加载类的对象
* 类加载器的作用：负责将.class文件加载到内存中，并为之生成对应的java.lang.Class类的对象
* JVM的类加载机制：
    * 全盘负责：当一个类加载器负责加载某个Class时，该Class所依赖的和引用的其他类也将由该类加载器负责载入，除非显示使用另一个类加载器加载
    * 父类委托：当一个类加载器负责加载某个Class时，先让父类加载器试图加载该Class，父类加载器无法加载时，再尝试从自己的类路径中加载该类
    * 缓存机制：所有加载过的Class都会被缓存，当程序使用某个Class对象时，类加载器首先从缓存区中搜索该Class，缓存区不存在该Class对象时，系统才会读取该类对应的二进制数据，将其转换为Class对象，存入缓存区